@use "../tokens/breakpoints.scss" as bp;

/* ============================================
   Interactive Case Study Section
   ============================================

   Responsive case study gallery with hover previews.
   Two layouts: list (desktop) and cards (mobile).

   Desktop (â‰¥768px):
   - Two-column list layout (title left, description right)
   - Hover reveals centrally positioned preview image
   - Clip-path reveal animation
   - Subtle theme-aware background on hover

   Mobile (<768px):
   - Card layout with images
   - Stacked vertically
   - Touch-friendly interactions

   Theme Integration:
   - Uses CSS custom properties for colors
   - Adapts to light/dark theme automatically
   - Smooth transitions using design tokens
*/

/* ============================================
   SECTION CONTAINER
   ============================================ */

/* Main section - transparent to show parent background (FluidGradient) */
.interactive-case-study-section {
  /* Transparent - allows FluidGradient or other backgrounds to show through */
  background: transparent;
}

/* Section title */
.section-title {
  color: var(--theme-text-60);
  font-size: var(--step-1); /* Fluid 12-16px */
  font-weight: 400;
  letter-spacing: 0.02em;
}

/* Container for list items */
.case-study-list {
  display: flex;
  flex-direction: column;
  position: relative;
  z-index: 1;
}

/* ============================================
   DESKTOP HOVER PREVIEW (Phase 2: Cursor-Following)
   ============================================ */

/* Preview container - positioned by GSAP, follows cursor */
.preview-container {
  /* GSAP handles positioning (no static centering) */
  position: fixed;
  top: 0;
  left: 0;

  /* Size constraints */
  width: 50vw;
  max-width: 700px;
  aspect-ratio: 4 / 3;

  /* Non-interactive (allows clicks to pass through to list) */
  pointer-events: none;

  /* Above list items */
  z-index: 10;

  /* Performance optimization for smooth cursor following */
  will-change: transform;
}

/* Dual-image wrapper - enables crossfade transitions */
.preview-image-wrapper {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;

  /* Start hidden for crossfade */
  opacity: 0;

  /* Smooth opacity transitions handled by GSAP */
  /* Clip-path for initial reveal handled by GSAP */
}

/* Active image wrapper (visible during crossfade) */
.preview-image-wrapper.active {
  opacity: 1;
}

/* Preview image */
.preview-image {
  width: 100%;
  height: 100%;
  object-fit: cover;
  border-radius: 0.5rem;

  /* Performance optimization for parallax */
  will-change: transform;
}

/* ============================================
   DESKTOP LIST ITEM
   ============================================ */

/* Items are nested full-width-content (inside list which is also full-width-content) */
/* Need explicit rule since content-grid.scss only handles direct children */
/* IMPORTANT: Only apply on desktop to respect Tailwind's 'hidden' class on mobile */
@include bp.up(bp.$bp-md) {
  .full-width-content > .case-study-item.full-width-content {
    grid-column: full-width;
    display: grid !important; /* Override Tailwind md:block */
    grid-template-columns: inherit;
  }
}

.case-study-item {
  /* Remove link styling */
  text-decoration: none;

  /* Vertical spacing - only bottom padding so border line is at top */
  padding: 0 0 var(--space-s) 0; /* Fluid 18-22px */

  /* Smooth background transition on hover */
  background: transparent;
  transition: background-color var(--duration-hover) var(--ease-power2);
}

.case-study-item:hover {
  /* Full-width solid background on hover (theme-aware) */
  /* Light theme: white, Dark theme: black */
  background-color: var(--theme-100);
}

/* Border line element - uses full-width class within sub-grid */
.item-border-line {
  grid-column: full-width;
  height: 1px;
  background-color: color-mix(in srgb, var(--theme-text-100) 10%, transparent);
  margin-bottom: var(--space-s); /* Fluid 18-22px */
  /* Will be animated with bouncy effect later */
}
/* Note: Already hidden on mobile via parent's "hidden md:block" Tailwind class */

/* Content wrapper - uses breakout3 class within sub-grid */
.item-content {
  /* breakout3 class handles grid-column placement */
  /* Manual grid for internal two-column layout */
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: var(--space-m); /* Fluid 27-33px */
}

/* Left column: Title + Tag */
.item-title-col {
  display: flex;
  align-items: baseline;
  gap: var(--space-2xs); /* Fluid 9-11px */
  flex-wrap: wrap;
}

.item-title {
  color: var(--theme-text-100);
}

.item-tag {
  color: var(--theme-text-60);
  text-transform: uppercase;
  letter-spacing: 0.05em;
}

/* Right column: Description */
.item-description-col {
  display: flex;
  align-items: center;
  justify-content: flex-end;
  text-align: right;
}

.item-description {
  color: var(--theme-text-100);
}

/* ============================================
   MOBILE CARD
   ============================================ */

.case-study-card {
  flex-direction: column;
  gap: var(--space-2xs); /* Fluid 9-11px */
  margin-bottom: var(--space-s); /* Fluid 18-22px */
  text-decoration: none;
  overflow: hidden;
}

/* Card image container - square (1:1) for mobile */
.card-image-container {
  width: 100%;
  aspect-ratio: 1 / 1; /* Square aspect ratio (320x320 in design, scales responsively) */
  overflow: hidden;
  border-radius: 0.5rem;
}

.card-image {
  width: 100%;
  height: 100%;
  object-fit: cover;

  /* Subtle scale on touch/active */
  transition: transform var(--duration-hover) var(--ease-power2);
}

.case-study-card:active .card-image {
  transform: scale(1.05);
}

/* Card content section */
.card-content {
  display: flex;
  flex-direction: column;
  gap: var(--space-3xs); /* Fluid 5-6px */
}

/* Card header: Title + Tag */
.card-header {
  display: flex;
  align-items: baseline;
  gap: var(--space-3xs-2xs); /* Fluid 5-11px */
  flex-wrap: wrap;
}

.card-title {
  color: var(--theme-text-100);
}

.card-tag {
  color: var(--theme-text-60);
  text-transform: uppercase;
  letter-spacing: 0.05em;
}

.card-description {
  color: var(--theme-text-100);
}

/* ============================================
   RESPONSIVE ADJUSTMENTS
   ============================================ */

/* Desktop adjustments for larger screens */
@include bp.up(bp.$bp-lg) {
  /* Larger preview on bigger screens */
  .preview-container {
    width: 45vw;
    max-width: 800px;
  }

  /* More generous spacing */
  .case-study-item {
    padding: 0 0 var(--space-m) 0; /* Fluid 27-33px */
  }

  .item-content {
    gap: var(--space-l); /* Fluid 36-44px */
  }
}

/* Extra large screens */
@include bp.up(bp.$bp-2xl) {
  .item-content {
    gap: var(--space-xl); /* Fluid 54-66px */
  }
}
